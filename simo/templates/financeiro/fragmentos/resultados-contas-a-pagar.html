{% load static %}
<div class="row" ><span class="text-center">Resultados:</span></div>
<div class="" style="margin-left:2em; margin-right:2em;">
<table class="table table-sm table-bordered dt-responsive tabela-listar" >
    <thead style="border:solid 1px;border-color:silver;background:#0d6efd; color: white;">
        <tr>
            <th scope="col" class="text-center">#</th>
            <th scope="col" class="text-center">Documento</th>
            <th scope="col">Fornecedor</th>
            <th scope="col">CPF/CNPJ</th>
            <th scope="col" class="text-center">NF nº</th>
            <th scope="col" class="text-center">Vencimento</th>
            <th scope="col" class="text-center">Valor</th>
            <th scope="col" class="text-center">Acrésc.</th>
            <th scope="col" class="text-center">Total</th>
            <th scope="col" class="text-center">Pago em</th>
        </tr>
    </thead>
    <tbody>
        {% if contas_atrasadas and contas_atrasadas.count > 0  %}
        {% for item in contas_atrasadas %}
        <tr>
            <td class="limitar_forloop text-center">{{forloop.counter}}</td>
            {% if item.doc %}<td class="text-center">{{item.doc}}</td>{% else %}<td class="text-center"> - </td>{% endif %}
            {% if item.conta.saida.fornecedor %}<td class="limitar_td"
                style="text-align: left; vertical-align:middle !important" title=""><a
                    href="{% url 'detalhar-fornecedor' item.conta.saida.fornecedor.pk %}"
                    title="">{{item.conta.saida.fornecedor}}</a></td>{% else %}<td> - </td>
            {% endif %}
            {% if item.conta.saida.fornecedor %}<td class="limitar_td" title="">{{item.conta.saida.fornecedor.doc}}</td>{% else %}<td> - </td>{% endif %}
            {% if item.conta.saida.nota_fiscal %}<td class="text-center limitar_td"><a href="{% url 'ver-nota-completa' item.conta.pk %}" target="_blank" class="">{{item.conta.saida.nota_fiscal}}</a></td>{% else %}<td class="text-center"> - </td>{% endif %}

            <td class="destaque-saida text-center">{{item.data_vencimento | date:"d/m/Y"}}
            </td>
            <td class="destaque-saida text-center">{{item.valor}}</td>
            {% if item.acrescimos %}<td class="text-center">{{item.acrescimos}}</td>{% else %}<td class="text-center"> 0,00 </td>{% endif %}
            {% if item.total %}<td class="destaque-saida text-center">{{item.total}}</td>{% else %}<td class="text-center"> {{item.valor}} </td>{% endif %}
            {% if item.pago %}<td class="text-center"> Pago </td>{% else %}<td class="text-center"> Aberto </td>{% endif %}
        </tr>
        {% endfor %}
        {% else %}
        <tr>
            <td style="text-align: center; color: gray;" colspan="9">Nenhum registro</td>
        </tr>
        {% endif %}
    </tbody>
</table>
</div>
{% if contas_atrasadas and contas_atrasadas.count > 0  %}
    <ol class="list-group ">
        <li class="list-group-item d-flex  justify-content-end mt-1 ">
            <div class="col-3">
                Resumo dos resultados:
            </div>
            
            <div class="col-3 text-end">
                Total de Contas: <h6 class="">{{contas_atrasadas.count}}</h6>
            </div>
            <div class="col-3 text-end">
                Total Acréscimos: <h6 class="">R$ {{total_acresc}}</h6>
            </div>
            <div class="col-3 text-end">
                Total: <h6 class="">R$ {{total}}</h6>
            </div>


        </li>
    </ol>
    {% endif %}


<script src="{% static 'js/datatables.min.js' %}"></script>
<script>
    $(document).ready(function () {


        $('.tabela-listar').DataTable({
            responsive: true,
            // "bSort": false,
            "aaSorting": [],
            "pageLength": 10,
            "order": [
                [2, "desc"]
            ], //3º tabela em ordem decrescente
            "language": {

                "decimal": ",",
                "emptyTable": "Sem registro",
                "info": "Mostrando de _START_ até _END_ de _TOTAL_ registros",
                "infoEmpty": "Mostrando de 0 até 0 de 0 registros",
                "infoFiltered": "(filtrado de _MAX_ registros no total)",
                "infoPostFix": "",
                "thousands": ".",
                "lengthMenu": "Mostrar _MENU_ registros",
                "loadingRecords": "A carregar dados...",
                "processing": "A processar...",
                "search": "Procurar:",
                "zeroRecords": "Não foram encontrados resultados",
                "paginate": {
                    "first": "Primeiro",
                    "last": "Último",
                    "next": "Seguinte",
                    "previous": "Anterior"
                },
                "aria": {
                    "sortAscending": ": ordem crescente",
                    "sortDescending": ": ordem decrescente"
                }
            }
        });


    });
</script>
